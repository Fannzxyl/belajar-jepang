<!DOCTYPE html>
<html lang="id" data-theme="pastel">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Tabel Kana Jepang ‚Äî Hiragana & Katakana</title>
    <meta name="description" content="Tabel lengkap Hiragana dan Katakana (Dasar, Dakuon, Handakuon, Youon) yang interaktif. Klik untuk mendengar audio pelafalan." />
    <meta name="theme-color" content="#7a6cff">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;700&family=Noto+Serif+JP:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        /* Menggunakan style yang sama dari index.html untuk konsistensi */
        :root{
            --bg:#f8fbff; --panel:#ffffff; --soft:#f2f6ff; --ink:#132030; --muted:#76849c;
            --pri:#7a6cff; --sec:#16c6a1; --warn:#ff7b7b; --ok:#2fb875; --accent:#ffd166;
            --btn:#e9eefc; --btnText:#0b101a; --border:rgba(19,32,48,.10);
            --radius:18px; --shadow:0 6px 18px rgba(15,23,34,.08);
            --ring: 0 0 0 3px rgba(122,108,255,.28);
            --iconColor: var(--muted);
            --transition-duration: 0.2s;
        }
        [data-theme="hc"]{
            --bg:#0a0f1a; --panel:#0f1626; --soft:#0c1220; --ink:#e6efff; --muted:#9fb0cc;
            --pri:#8fa8ff; --sec:#3dd8b5; --warn:#ff8c8c; --ok:#7be0b3; --accent:#ffd98a;
            --btn:#18243a;
            --btnText:#e6efff;
            --border:rgba(230,239,255,.12);
            --ring: 0 0 0 3px rgba(143,168,255,.35);
            --iconColor: var(--ink);
        }
        *{box-sizing:border-box}
        html, body { max-width: 100%; overflow-x: hidden; }
        body {
            min-height: 100svh;
            margin:0;font-family:'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;background:
            radial-gradient(900px 420px at -10% -20%, rgba(122,108,255,.10), transparent),
            radial-gradient(900px 420px at 110% -30%, rgba(22,198,161,.12), transparent),
            var(--bg);color:var(--ink);
            transition: background-color var(--transition-duration) ease-out, color var(--transition-duration) ease-out;
            line-height: 1.6; /* Tambahan untuk keterbacaan */
        }
        .wrap{
            max-width: 1200px; /* Lebar untuk tabel */
            margin: auto;
            padding: 16px;
            padding-left: calc(16px + env(safe-area-inset-left));
            padding-right: calc(16px + env(safe-area-inset-right));
        }
        header{position:sticky;top:0;z-index:30;background:linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.72));backdrop-filter: blur(8px);border-bottom:1px solid var(--border); padding-top:env(safe-area-inset-top);
        transition: background var(--transition-duration) ease-out, backdrop-filter var(--transition-duration) ease-out, border-bottom-color var(--transition-duration) ease-out;}
        [data-theme="hc"] header{background:linear-gradient(180deg, rgba(15,22,38,.86), rgba(15,22,38,.66))}
        
        .brand{ display:flex; align-items:center; gap:12px; justify-content: space-between; flex-wrap: wrap; }
        .logo{width:36px;height:36px;border-radius:12px;background:linear-gradient(135deg,var(--pri),var(--sec));box-shadow:var(--shadow);
        transition: box-shadow var(--transition-duration) ease-out, background var(--transition-duration) ease-out;}
        h1{font-size:20px;margin:0}
        .small{font-size:12px;color:var(--muted)}
        .card{background:var(--panel);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px;border:1px solid var(--border);
        transition: background-color var(--transition-duration) ease-out, border-color var(--transition-duration) ease-out, box-shadow var(--transition-duration) ease-out;}
        .card h2{font-size:16px;margin:0 0 10px 0; display: flex; align-items: center; gap: 8px;}
        .card h3{font-size:14px; margin: 16px 0 8px 0; color: var(--muted);}
        .card h2 .icon { color: var(--iconColor); transition: color var(--transition-duration) ease-out;}
        .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
        .btn{ min-height:52px; padding: 0 16px; border-radius: 12px; border: none; cursor: pointer; font-size: 14px; font-weight: 500; transition: all var(--transition-duration) ease-out; color: var(--ink); background: var(--btn); display: flex; align-items: center; justify-content: center; gap: 8px; text-decoration: none; }
        .btn:active{transform:translateY(1px)}
        .btn.primary{ background:linear-gradient(135deg, var(--pri), var(--sec)); color:white; }
        .btn.ghost{background:transparent;outline:1px solid var(--border); color: var(--ink);}
        .btn:focus-visible{outline:none; box-shadow:var(--ring); outline-offset: 3px;}
        .spacer{height:16px}
        /* Sembunyikan nav/header lama kalau ada */
        .main-nav{ display:none !important; }

        .seg{display:flex;border:1px solid var(--border);border-radius:12px;overflow:hidden; transition: border-color var(--transition-duration) ease-out;}
        .seg button{ flex:1; background:var(--soft); border:none; padding: 12px 16px; font-size: 14px; cursor: pointer; transition: all var(--transition-duration) ease-out; color: var(--ink); }
        .seg button.active{background:linear-gradient(135deg, rgba(122,108,255,.18), rgba(22,198,161,.18))}
        [data-theme="hc"] .seg button.active{background:linear-gradient(135deg, rgba(143,168,255,.15), rgba(61,216,181,.15))}

        /* Style khusus untuk Tabel Kana */
        .kana-table-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        .kana-table {
            width: 100%; /* Memastikan tabel mengisi lebar container */
            border-collapse: collapse;
            text-align: center;
            font-family: 'Noto Sans JP', sans-serif;
            min-width: 500px; /* Minimal lebar tabel untuk mencegah terlalu padat di mobile */
        }
        .kana-table th, .kana-table td {
            border: 1px solid var(--border);
            padding: 8px;
            min-width: 50px; /* Mengurangi min-width default untuk sel */
        }
        .kana-table th {
            background-color: var(--soft);
            font-weight: 600;
            color: var(--muted);
            padding: 10px 5px; /* Sedikit mengurangi padding header */
        }
        .kana-table td {
            cursor: pointer;
            transition: background-color var(--transition-duration) ease-out;
        }
        .kana-table td:hover {
            background-color: var(--soft);
        }
        .kana-table:focus-within td[data-kana]:hover { /* Add focus-within for accessibility */
            background-color: var(--soft);
        }
        .kana-char {
            font-size: 24px; /* Sedikit mengurangi ukuran font kana */
            line-height: 1.2;
        }
        .romaji-char {
            font-size: 11px; /* Sedikit mengurangi ukuran font romaji */
            color: var(--muted);
        }
        .empty-cell {
            background-color: rgba(0,0,0,0.02);
        }
        [data-theme="hc"] .empty-cell {
            background-color: rgba(255,255,255,0.04);
        }

        /* === Sidebar === */
        .sidebar{
            position:fixed; top:0; left:-300px; width:280px; height:100%;
            background:var(--panel); box-shadow:var(--shadow); z-index:1000;
            transition:left .3s ease-in-out; padding:20px; padding-top:calc(20px + env(safe-area-inset-top));
            display:flex; flex-direction:column; gap:10px; overflow-y:auto; border-right:1px solid var(--border);
        }
        .sidebar.is-open{ left:0; }
        .sidebar .menu{ list-style:none; margin:0; padding:0; }
        .sidebar .menu li a{
            display:flex; gap:.5rem; align-items:center; padding:.75rem 1rem;
            border-radius:12px; color:var(--ink); text-decoration:none;
        }
        .sidebar .menu li a:hover{ background:var(--soft); }
        .sidebar .menu li a.active{ background:rgba(122,108,255,.12); font-weight:600; }

        /* Toggle button */
        .sidebar-toggle-btn{
            position:fixed; top:16px; left:16px; z-index:1001; background:var(--btn);
            border:1px solid var(--border); border-radius:50%; width:44px; height:44px;
            display:flex; align-items:center; justify-content:center; cursor:pointer; box-shadow:var(--shadow);
            transition: all 0.3s ease-in-out; /* Added transition for smooth movement */
        }
        .sidebar-toggle-btn i{ color:var(--ink); font-size:20px; }

        @media (min-width:768px){ 
            body.sidebar-open{ padding-left:280px; } 
            .sidebar-toggle-btn { left: 16px; } /* Stays on the left */
            .sidebar.is-open + .sidebar-toggle-btn { left: 296px; } /* Moves with the sidebar */
        }
        @media (max-width:640px){ .sidebar{ width:84vw; max-width:320px; } }

        /* Amanin layout */
        header .brand{ position:relative; z-index:1002; padding-left:60px; }
        @media (max-width:767px){
            header .brand{ padding-left:0; }
            .sidebar-toggle-btn{ top:calc(16px + env(safe-area-inset-top)); }
        }

        /* Media Queries untuk Responsivitas */

        /* Untuk layar kecil (ponsel), e.g., lebar < 768px */
        @media (max-width: 767px) {
            .wrap {
                padding: 12px; /* Mengurangi padding wrap di mobile */
                padding-left: calc(12px + env(safe-area-inset-left));
                padding-right: calc(12px + env(safe-area-inset-right));
            }
            .card {
                padding: 12px; /* Mengurangi padding kartu di mobile */
            }
            .card h2 {
                font-size: 18px; /* Mengurangi ukuran judul kartu */
            }
            h1 {
                font-size: 18px; /* Mengurangi ukuran judul utama */
            }
            .small {
                font-size: 11px; /* Mengurangi ukuran teks kecil */
            }
            .btn {
                min-height: 48px; /* Mengurangi tinggi tombol */
                padding: 0 12px;
                font-size: 13px; /* Mengurangi ukuran font tombol */
            }
            .main-nav .row {
                gap: 6px; /* Mengurangi jarak antar tombol navigasi */
            }
            .seg button {
                padding: 10px 12px; /* Mengurangi padding tombol segmen */
                font-size: 13px;
            }
            .kana-table th, .kana-table td {
                padding: 6px 4px; /* Mengurangi padding sel tabel di mobile */
                min-width: 45px; /* Minimal lebar sel tabel di mobile */
            }
            .kana-char {
                font-size: 20px; /* Mengurangi ukuran font karakter Kana */
            }
            .romaji-char {
                font-size: 10px; /* Mengurangi ukuran font karakter Romaji */
            }
        }

        /* Untuk layar sedang (tablet, laptop kecil), e.g., 768px - 1023px */
        @media (min-width: 768px) and (max-width: 1023px) {
            .wrap {
                padding: 24px;
            }
            .kana-table th, .kana-table td {
                padding: 8px 6px;
                min-width: 60px;
            }
            .kana-char {
                font-size: 26px;
            }
            .romaji-char {
                font-size: 12px;
            }
        }

        /* Untuk layar besar (laptop, desktop), e.g., >= 1024px */
        @media (min-width: 1024px) {
            .main-nav .row {
                justify-content: flex-end; /* Navigasi rata kanan di layar besar */
            }
            .kana-table th, .kana-table td {
                padding: 10px;
                min-width: 70px;
            }
            .kana-char {
                font-size: 28px;
            }
            .romaji-char {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- Toggle Button (burger) -->
    <button id="sidebarToggle" class="sidebar-toggle-btn" aria-label="Toggle Sidebar">
        <i class="fa-solid fa-bars"></i>
    </button>

    <!-- Sidebar -->
    <nav id="sidebar" class="sidebar">
        <div class="row" style="justify-content: space-between; align-items: center;">
            <h3 style="margin:0;">Navigasi</h3>
            <button class="btn ghost" id="closeSidebar" aria-label="Tutup Sidebar">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <hr style="border:none;border-top:1px solid var(--border);width:100%;">
        <ul class="menu">
            <li><a href="index.html">üìò Latihan</a></li>
            <li><a href="index2.html">üóÇÔ∏è Flashcard</a></li>
            <li><a href="index3.html" class="active">üßÆ Tabel Kana</a></li>
            <li><a href="index4.html">üóíÔ∏è Kosakata</a></li>
            <li><a href="index5.html">üí¨ Ungkapan</a></li>
            <li><a href="index7.html">üß† Tebak Arti</a></li>
            <li><a href="index6.html">‚úçÔ∏è Menulis</a></li>
            <li><a href="index8.html">üìö Pelatih Membaca</a></li> <!-- Menambahkan link ke index8.html -->
        </ul>
    </nav>

    <header>
        <div class="wrap">
            <div class="brand">
                <svg class="logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="36" height="36">
                    <defs>
                        <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
                            <stop stop-color="#7a6cff"/><stop offset="1" stop-color="#16c6a1"/>
                        </linearGradient>
                    </defs>
                    <rect width="64" height="64" rx="14" fill="url(#g)"/>
                    <text x="50%" y="50%" text-anchor="middle" dominant-baseline="middle"
                          font-family="Noto Sans JP, 'Noto Serif JP', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif"
                          font-size="38" fill="white" dy="-2">„ÅÇ</text>
                </svg>
                <div>
                    <h1>Pelatih Kana Jepang</h1>
                    <div class="small">Tabel Hiragana & Katakana Lengkap</div>
                </div>
            </div>
            <!-- NAVIGASI UTAMA (LAMA - TERSEMBUNYI) -->
            <nav class="main-nav">
                <div class="row">
                    <a href="index.html" class="btn ghost"><i class="fa-solid fa-home"></i> Latihan</a>
                    <a href="index2.html" class="btn ghost"><i class="fa-solid fa-clone"></i> Flashcard</a>
                    <a href="index3.html" class="btn primary"><i class="fa-solid fa-table"></i> Tabel Kana</a>
                    <a href="index4.html" class="btn ghost"><i class="fa-solid fa-book-open"></i> Kosakata</a>
                    <a href="index5.html" class="btn ghost"><i class="fa-solid fa-comments"></i> Ungkapan</a>
                </div>
            </nav>
        </div>
    </header>

    <main class="wrap">
        <div class="card">
            <h2><i class="fa-solid fa-table icon"></i> Tabel Referensi Kana</h2>
            <div class="small">Pilih tabel yang ingin ditampilkan. Klik pada karakter untuk mendengar suaranya.</div>
            <div class="spacer"></div>
            <div class="seg" role="tablist" aria-label="Pilih Tabel">
                <button id="showHira" class="btn active" role="tab" aria-selected="true" type="button">Hiragana („Å≤„Çâ„Åå„Å™)</button>
                <button id="showKata" class="btn" role="tab" aria-selected="false" type="button">Katakana („Ç´„Çø„Ç´„Éä)</button>
            </div>
        </div>

        <div class="spacer"></div>

        <div class="card">
            <div id="tableContainer" class="kana-table-wrapper">
                <!-- Tabel akan digenerate oleh JavaScript di sini -->
            </div>
        </div>

        <div class="spacer"></div>

        <!-- Penambahan: CTA card "Tebak Arti" -->
        <div class="card" id="cta-tebak-arti">
          <h2><i class="fa-solid fa-brain icon"></i> Tebak Arti (JP‚ÜíID)</h2>
          <div class="small">Kuis arti Jepang ‚Üí Indonesia (A‚ÄìD). Pilih kategori & jumlah soal.</div>
          <div class="spacer"></div>
          <div class="row" style="gap:8px;flex-wrap:wrap">
            <a class="btn primary" href="index7.html"><i class="fa-solid fa-play"></i> Mulai Tebak Arti</a>
            <a class="btn ghost" href="index7.html#kategori"><i class="fa-solid fa-list"></i> Pilih Kategori</a>
          </div>
        </div>
    </main>

    <script>
        // DATA KANA (Sama seperti di file lain)
        const HIRA_MAP = new Map([
            ['a','„ÅÇ'], ['i','„ÅÑ'], ['u','„ÅÜ'], ['e','„Åà'], ['o','„Åä'],
            ['ka','„Åã'], ['ki','„Åç'], ['ku','„Åè'], ['ke','„Åë'], ['ko','„Åì'],
            ['sa','„Åï'], ['shi','„Åó'], ['su','„Åô'], ['se','„Åõ'], ['so','„Åù'],
            ['ta','„Åü'], ['chi','„Å°'], ['tsu','„Å§'], ['te','„Å¶'], ['to','„Å®'],
            ['na','„Å™'], ['ni','„Å´'], ['nu','„Å¨'], ['ne','„Å≠'], ['no','„ÅÆ'],
            ['ha','„ÅØ'], ['hi','„Å≤'], ['fu','„Åµ'], ['he','„Å∏'], ['ho','„Åª'],
            ['ma','„Åæ'], ['mi','„Åø'], ['mu','„ÇÄ'], ['me','„ÇÅ'], ['mo','„ÇÇ'],
            ['ya','„ÇÑ'], ['yu','„ÇÜ'], ['yo','„Çà'],
            ['ra','„Çâ'], ['ri','„Çä'], ['ru','„Çã'], ['re','„Çå'], ['ro','„Çç'],
            ['wa','„Çè'], ['wo','„Çí'], ['n','„Çì'],
            ['wi','„Çê'], // Huruf historis
            ['we','„Çë'], // Huruf historis
            ['ga','„Åå'], ['gi','„Åé'], ['gu','„Åê'], ['ge','„Åí'], ['go','„Åî'],
            ['za','„Åñ'], ['ji','„Åò'], ['zu','„Åö'], ['ze','„Åú'], ['zo','„Åû'],
            ['da','„Å†'], ['dji','„Å¢'], ['dzu','„Å•'], ['de','„Åß'], ['do','„Å©'],
            ['ba','„Å∞'], ['bi','„Å≥'], ['bu','„Å∂'], ['be','„Åπ'], ['bo','„Åº'],
            ['pa','„Å±'], ['pi','„Å¥'], ['pu','„Å∑'], ['pe','„Å∫'], ['po','„ÅΩ'],
            ['kya','„Åç„ÇÉ'], ['kyu','„Åç„ÇÖ'], ['kyo','„Åç„Çá'],
            ['sha','„Åó„ÇÉ'], ['shu','„Åó„ÇÖ'], ['sho','„Åó„Çá'],
            ['cha','„Å°„ÇÉ'], ['chu','„Å°„ÇÖ'], ['cho','„Å°„Çá'],
            ['nya','„Å´„ÇÉ'], ['nyu','„Å´„ÇÖ'], ['nyo','„Å´„Çá'], // Dikoreksi
            ['hya','„Å≤„ÇÉ'], ['hyu','„Å≤„ÇÖ'], ['hyo','„Å≤„Çá'],
            ['mya','„Åø„ÇÉ'], ['myu','„Åø„ÇÖ'], ['myo','„Åø„Çá'], // Dikoreksi
            ['rya','„Çä„ÇÉ'], ['ryu','„Çä„ÇÖ'], ['ryo','„Çä„Çá'],
            ['gya','„Åé„ÇÉ'], ['gyu','„Åé„ÇÖ'], ['gyo','„Åé„Çá'],
            ['ja','„Åò„ÇÉ'], ['ju','„Åò„ÇÖ'], ['jo','„Åò„Çá'],
            ['bya','„Å≥„ÇÉ'], ['byu','„Å≥„ÇÖ'], ['byo','„Å≥„Çá'],
            ['pya','„Å¥„ÇÉ'], ['pyu','„Å¥„ÇÖ'], ['pyo','„Å¥„Çá']
        ]);

        const KATA_MAP = new Map([
            ['a','„Ç¢'], ['i','„Ç§'], ['u','„Ç¶'], ['e','„Ç®'], ['o','„Ç™'],
            ['ka','„Ç´'], ['ki','„Ç≠'], ['ku','„ÇØ'], ['ke','„Ç±'], ['ko','„Ç≥'],
            ['sa','„Çµ'], ['shi','„Ç∑'], ['su','„Çπ'], ['se','„Çª'], ['so','„ÇΩ'],
            ['ta','„Çø'], ['chi','„ÉÅ'], ['tsu','„ÉÑ'], ['te','„ÉÜ'], ['to','„Éà'],
            ['na','„Éä'], ['ni','„Éã'], ['nu','„Éå'], ['ne','„Éç'], ['no','„Éé'],
            ['ha','„Éè'], ['hi','„Éí'], ['fu','„Éï'], ['he','„Éò'], ['ho','„Éõ'],
            ['ma','„Éû'], ['mi','„Éü'], ['mu','„É†'], ['me','„É°'], ['mo','„É¢'],
            ['ya','„É§'], ['yu','„É¶'], ['yo','„É®'],
            ['ra','„É©'], ['ri','„É™'], ['ru','„É´'], ['re','„É¨'], ['ro','„É≠'],
            ['wa','„ÉØ'], ['wo','„É≤'], ['n','„É≥'],
            ['wi','„É∞'], // Huruf historis
            ['we','„É±'], // Huruf historis
            ['ga','„Ç¨'], ['gi','„ÇÆ'], ['gu','„Ç∞'], ['ge','„Ç≤'], ['go','„Ç¥'],
            ['za','„Ç∂'], ['ji','„Ç∏'], ['zu','„Ç∫'], ['ze','„Çº'], ['zo','„Çæ'],
            ['da','„ÉÄ'], ['dji','„ÉÇ'], ['dzu','„ÉÖ'], ['de','„Éá'], ['do','„Éâ'],
            ['ba','„Éê'], ['bi','„Éì'], ['bu','„Éñ'], ['be','„Éô'], ['bo','„Éú'],
            ['pa','„Éë'], ['pi','„Éî'], ['pu','„Éó'], ['pe','„Éö'], ['po','„Éù'],
            ['kya','„Ç≠„É£'], ['kyu','„Ç≠„É•'], ['kyo','„Ç≠„Éß'],
            ['sha','„Ç∑„É£'], ['shu','„Ç∑„É•'], ['sho','„Ç∑„Éß'],
            ['cha','„ÉÅ„É£'], ['chu','„ÉÅ„É•'], ['cho','„ÉÅ„Éß'],
            ['nya','„Éã„É£'], ['nyu','„Éã„É•'], ['nyo','„Éã„Éß'],
            ['hya','„Éí„É£'], ['hyu','„Éí„É•'], ['hyo','„Éí„Éß'],
            ['mya','„Éü„É£'], ['myu','„Éü„É•'], ['myo','„Éü„Éß'],
            ['rya','„É™„É£'], ['ryu','„É™„É•'], ['ryo','„É™„Éß'],
            ['gya','„ÇÆ„É£'], ['gyu','„ÇÆ„É•'], ['gyo','„ÇÆ„Éß'], // Dikoreksi/Ditambahkan
            ['ja','„Ç∏„É£'], ['ju','„Ç∏„É•'], ['jo','„Ç∏„Éß'],
            ['bya','„Éì„É£'], ['byu','„Éì„É•'], ['byo','„Éì„Éß'],
            ['pya','„Éî„É£'], ['pyu','„Éî„É•'], ['pyo','„Éî„Éß']
        ]);

        // Struktur Tabel
        const VOWELS = ['a', 'i', 'u', 'e', 'o'];
        const BASE_CONSONANTS = ['', 'k', 's', 't', 'n', 'h', 'm', 'y', 'r', 'w'];

        // Alias untuk pengecualian gojuuon
        const ROMAJI_ALIASES = new Map([
          ['si','shi'],
          ['ti','chi'],
          ['tu','tsu'],
          ['hu','fu']
        ]);

        const DAKUON_CONSONANTS = ['g', 'z', 'd', 'b', 'p'];
        const YOUON_CONSONANTS = ['ky', 'sh', 'ch', 'ny', 'hy', 'my', 'ry', 'gy', 'j', 'by', 'py'];
        const YOUON_VOWELS = ['a', 'u', 'o'];


        const tableContainer = document.getElementById('tableContainer');
        const showHiraBtn = document.getElementById('showHira');
        const showKataBtn = document.getElementById('showKata');

        function createCell(kanaMap, romaji) {
            const td = document.createElement('td');
            const kana = kanaMap.get(romaji);
            if (kana) {
                td.innerHTML = `<div class="kana-char">${kana}</div><div class="romaji-char">${romaji}</div>`;
                td.dataset.kana = kana;
                // Event listener ditambahkan setelah tabel dibuat untuk performa
            } else {
                td.className = 'empty-cell';
            }
            return td;
        }

        function generateTable(type) {
            const kanaMap = type === 'hira' ? HIRA_MAP : KATA_MAP;
            let html = '';

            // 1. Tabel Dasar (Gojuuon)
            html += '<h3>Dasar (Gojuuon)</h3>';
            html += '<table class="kana-table"><thead><tr><th></th><th>A</th><th>I</th><th>U</th><th>E</th><th>O</th></tr></thead><tbody>';
            BASE_CONSONANTS.forEach(c => {
                html += `<tr><th>${c.toUpperCase()}</th>`;
                VOWELS.forEach(v => {
                  let romaji = c + v;
                  if (ROMAJI_ALIASES.has(romaji)) romaji = ROMAJI_ALIASES.get(romaji);

                  const kana = kanaMap.get(romaji);

                  // Kosongkan hanya yang benar-benar tidak ada di kana modern
                  if (['yi','ye','wu'].includes(romaji)) {
                    html += '<td class="empty-cell"></td>';
                  } else if (kana) {
                    html += `<td data-kana="${kana}">
                               <div class="kana-char">${kana}</div>
                               <div class="romaji-char">${romaji}</div>
                             </td>`;
                  } else {
                    html += '<td class="empty-cell"></td>';
                  }
                });
                html += '</tr>';
            });
            html += `<tr><th></th><td data-kana="${kanaMap.get('n')}"><div class="kana-char">${kanaMap.get('n')}</div><div class="romaji-char">n</div></td><td colspan="4" class="empty-cell"></td></tr>`;
            html += '</tbody></table>';

            // 2. Tabel Dakuon & Handakuon
            html += '<div class="spacer"></div><h3>Dakuon („Çõ) & Handakuon („Çú)</h3>';
            html += '<table class="kana-table"><thead><tr><th></th><th>A</th><th>I</th><th>U</th><th>E</th><th>O</th></tr></thead><tbody>';
            DAKUON_CONSONANTS.forEach(c => {
                html += `<tr><th>${c.toUpperCase()}</th>`;
                VOWELS.forEach(v => {
                    let romaji = c + v;
                    if (c === 'z' && v === 'i') romaji = 'ji';
                    else if (c === 'd' && v === 'i') romaji = 'dji';
                    else if (c === 'd' && v === 'u') romaji = 'dzu';
                    
                    const kana = kanaMap.get(romaji);
                    if (kana) {
                        html += `<td data-kana="${kana}"><div class="kana-char">${kana}</div><div class="romaji-char">${romaji}</div></td>`;
                    } else {
                        html += '<td class="empty-cell"></td>';
                    }
                });
                html += '</tr>';
            });
            html += '</tbody></table>';
            
            // 3. Tabel Youon
            html += '<div class="spacer"></div><h3>Youon (ÊãóÈü≥)</h3>';
            html += '<table class="kana-table"><thead><tr><th></th><th>YA</th><th>YU</th><th>YO</th></tr></thead><tbody>';
            YOUON_CONSONANTS.forEach(c => {
                    html += `<tr><th>${c.toUpperCase().replace('SH', 'SH').replace('CH', 'CH').replace('NY', 'NY').replace('HY', 'HY').replace('MY', 'MY').replace('RY', 'RY').replace('GY', 'GY').replace('J', 'J').replace('BY', 'BY').replace('PY', 'PY')}</th>`; // Menggunakan upperCase untuk konsonan Youon
                    YOUON_VOWELS.forEach(v => {
                        let romaji = c + v;
                        if (c === 'j') { // 'ja', 'ju', 'jo'
                            romaji = (v === 'a' ? 'ja' : v === 'u' ? 'ju' : 'jo');
                        } else if (['sh', 'ch'].includes(c) && v === 'i') { 
                            html += '<td class="empty-cell"></td>';
                            return;
                        }

                        const kana = kanaMap.get(romaji);
                        if (kana) {
                            html += `<td data-kana="${kana}"><div class="kana-char">${kana}</div><div class="romaji-char">${romaji}</div></td>`;
                        } else {
                            html += '<td class="empty-cell"></td>';
                        }
                    });
                    html += '</tr>';
            });
            html += '</tbody></table>';

            tableContainer.innerHTML = html;
            
            // Tambahkan event listener setelah tabel dibuat
            document.querySelectorAll('.kana-table td[data-kana]').forEach(cell => {
                cell.addEventListener('click', () => speak(cell.dataset.kana));
            });
        }
        
        function speak(text) {
            try {
                if (!('speechSynthesis' in window)) {
                    // Mengganti alert dengan console.warn atau pesan di UI jika diinginkan
                    console.warn('Maaf, browser Anda tidak mendukung audio.');
                    return;
                }
                speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'ja-JP';
                utterance.rate = 0.9;
                speechSynthesis.speak(utterance);
            } catch (error) {
                console.error('Error speaking text:', error);
            }
        }

        showHiraBtn.addEventListener('click', () => {
            generateTable('hira');
            showHiraBtn.classList.add('active');
            showKataBtn.classList.remove('active');
        });

        showKataBtn.addEventListener('click', () => {
            generateTable('kata');
            showKataBtn.classList.add('active');
            showHiraBtn.classList.remove('active');
        });

        // Inisialisasi
        document.addEventListener('DOMContentLoaded', () => {
            generateTable('hira'); // Tampilkan Hiragana secara default
        });

        // --- SIDEBAR JS ---
        (() => {
            const sidebar  = document.getElementById('sidebar');
            const toggle   = document.getElementById('sidebarToggle');
            const closeBtn = document.getElementById('closeSidebar');

            function open(){ sidebar.classList.add('is-open'); document.body.classList.add('sidebar-open'); }
            function close(){ sidebar.classList.remove('is-open'); document.body.classList.remove('sidebar-open'); }

            toggle?.addEventListener('click', open);
            closeBtn?.addEventListener('click', close);

            // Klik luar = tutup (mobile)
            document.addEventListener('click', (e)=>{
                if(!sidebar.classList.contains('is-open')) return;
                const hit = sidebar.contains(e.target) || toggle.contains(e.target);
                if(!hit) close();
            });
            // ESC = tutup
            document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') close(); });

            // Tandai link aktif sesuai pathname
            document.querySelectorAll('#sidebar a').forEach(a=>{
                const href = a.getAttribute('href');
                // Use endsWith for robustness with different base paths
                if(href && location.pathname.endsWith(href)) {
                    a.classList.add('active');
                } else {
                    a.classList.remove('active'); // Ensure other links are not active
                }
            });
        })();
    </script>
</body>
</html>
